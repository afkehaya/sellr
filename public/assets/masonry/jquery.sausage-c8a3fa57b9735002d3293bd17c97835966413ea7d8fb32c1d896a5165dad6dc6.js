!function(e){e.widget("cc.sausage",{options:{page:".page",content:function(e){return'<span class="sausage-span">'+(e+1)+"</span>"}},_create:function(){var s=this,t=s.element;s.$outer=t,s.$inner=e.isWindow(s.element.get(0))?e("body"):t.children(":first-child"),s.$sausages=e('<div class="sausage-set"/>'),s.sausages=s.$sausages.get(0),s.offsets=[],s.$sausages.appendTo(s.$inner),s._trigger("create")},_init:function(){var e=this;return e.$outer.height()>=e.$inner.height()?void e.destroy():(e.draw(),e._update(),e._events(),e._delegates(),e.$sausages.addClass("sausage-set-init"),e.blocked=!1,void e._trigger("init"))},_events:function(){var e=this;e.hasScrolled=!1,e.$outer.bind("resize.sausage",function(){e.draw()}).bind("scroll.sausage",function(){e.hasScrolled=!0}),setInterval(function(){e.hasScrolled&&(e.hasScrolled=!1,e._update())},250)},_getCurrent:function(){var e=this,s=e.$outer.scrollTop()+e._getHandleHeight(e.$outer,e.$inner)/4,t=(e.$outer.height(),e.$inner.height(),0);for(l=e.offsets.length;t<l;t++){if(!e.offsets[t+1])return t;if(s<=e.offsets[t])return t;if(s>e.offsets[t]&&s<=e.offsets[t+1])return t}return t},_delegates:function(){var s=this;s.$sausages.delegate(".sausage","hover",function(){s.blocked||e(this).toggleClass("sausage-hover")}).delegate(".sausage","click",function(t){if(t.preventDefault(),!s.blocked){var a=e(this),n=a.index(),i=s.$inner.find(s.options.page).eq(n).offset().top;s._scrollTo(i),s._trigger("onClick",t,{$sausage:a,i:n}),a.hasClass("current")||s._trigger("onUpdate",t,{$sausage:a,i:n})}})},_scrollTo:function(s){var t=this,a=t.$outer,n=2,i=t.offsets[t.current]-s,r=Math.abs(i/n);r=1e3>r?r:1e3,t.$outer.get(0)===window&&(a=e("body, html, document")),a.stop(!0).animate({scrollTop:s},r)},_handleClick:function(){},_update:function(){var e=this;i=e._getCurrent(),c="sausage-current",i===e.current||e.blocked||(e.current=i,e.$sausages.children().eq(i).addClass(c).siblings().removeClass(c),e._trigger("update"))},_getHandleHeight:function(e,s){var t=e.height(),a=s.height();return t/a*t},draw:function(){var e,s,t,a=this,n=a.$outer.height(),i=a.$inner.height(),r=a.$inner.find(a.options.page),o=[];a.offsets=[],a.count=r.length,a.$sausages.detach().empty();for(var u=0;u<a.count;u++)e=r.eq(u),s=e.offset(),t=s.top/i*n,o.push('<div class="sausage'+(u===a.current?" sausage-current":"")+'" style="height:'+e.outerHeight()/i*n+"px;top:"+t+'px;">'+a.options.content(u,e)+"</div>"),a.offsets.push(s.top);a.sausages.innerHTML=o.join(""),a.$sausages.appendTo(a.$inner)},block:function(){var e=this,s="sausage-set-blocked";e.blocked=!0,e.$sausages.addClass(s)},unblock:function(){var e=this,s="sausage-set-blocked";e.$sausages.removeClass(s),e.blocked=!1},destroy:function(){var e=this;e.$outer.unbind(".sausage"),e.$sausages.remove()}})}(jQuery);